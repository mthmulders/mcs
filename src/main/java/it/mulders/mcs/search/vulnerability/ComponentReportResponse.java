package it.mulders.mcs.search.vulnerability;

import java.util.Arrays;
import java.util.Comparator;

public record ComponentReportResponse(ComponentReport[] componentReports) {
    public record ComponentReport(String coordinates, String reference, ComponentReportVulnerability[] vulnerabilities) {
        public ComponentReportVulnerability[] vulnerabilitiesSortedByCvssScore() {
            ComponentReportVulnerability[] sorted = Arrays.copyOf(vulnerabilities, vulnerabilities.length);
            Arrays.sort(sorted, Comparator.comparingDouble(ComponentReportVulnerability::cvssScore).reversed());
            return sorted;
        }

        public record ComponentReportVulnerability(String id, String title, Double cvssScore, String reference) {
        }
    }
}
